---
layout: post
published: false
draft: false
tags: R 
status: process
title: "L'analyse de chevauchement"
author: "Charles Joly Beauparlant"
output: html_document
---

```{r chargerLibrairies}
library(IRanges)
```

### 1. findOverlaps

La fonction findOverlaps permet de décrire tous les chevauchements entre 2 groupes de régions.

On doit commencer par créer deux groupes de régions:

```{r findOverlapsCreerRegions}
qry <- IRanges(start=c(1, 26, 19, 11, 21, 7), end=c(16, 30, 19, 15, 24, 8),
names=letters[1:6])
sbj <- IRanges(start=c(1, 19, 10), end=c(5, 29, 16), names=letters[24:26])
qry
sbj
```

On peut ensuite faire l'analyse des chevauchement en tant que telle:

```{r findOverlaps}
hts <- findOverlaps(qry, sbj)
hts
```

Pour extraire l'information de l'objet retourné par la fonction `findOverlaps`, on peut utiliser les fonctions `queryHits`, `subjectHits` ou encore convertir en `data.frame` avec la fonction `as.data.frame`:

```{r analyserFindOverlaps}
queryHits(hts)
subjectHits(hts)
as.data.frame(hts)
```

### 2. subsetByOverlaps

La fonction `subsetByOverlaps` permet de conserver uniquement les régions qui se retrouvent dans une seconde liste de région:

```{r subsetByOverlaps}
subsetByOverlaps(qry, sbj)
subsetByOverlaps(qry, sbj[1:2])
```

### 3. countOverlaps

La fonction `countOverlaps` permet de calculer le nombre de régions qui chevauche chaque régions dans un groupe de région.

```{r countOverlaps}
countOverlaps(sbj, qry)
```

### 3. distanceToNearest

La fonction `distanceToNearest` retourne la région la plus proche parmi une liste de région:

```{r distanceToNearest}
qry <- IRanges(sample(seq_len(1000), 5), width=10)
sbj <- IRanges(sample(seq_len(1000), 5), width=10)
qry
sbj
distanceToNearest(qry, sbj)
```
